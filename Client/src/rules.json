{
    "Messages": {
        "DisallowedKeyword": "Use of the keyword '{1}' is not permitted",
        "NotPermitted": "Use of '{1}' is not permitted",
        "ExternalDependency": "Use of '{1}' is not permitted here, as this would make the function dependent on a variable not passed in as a parameter",
        "MutatingMethod": "Use of '{1}', or any other method that mutates a List is not permitted",
        "Assignment": "Use of single '=', signifying assignment, is not permitted. (To test for equality, use '==')"
    },
    "ServerResponseMessageFilters": {
        "csharp": {
            "cmpinfo": "CS.*",
            "stderr": "\\w+Exception"
        },
        "python": {
            "cmpinfo": "\\s\\w*Error:.*",
            "stderr": "\\s\\w*Error:.*"
        }
    },
    "CodeMustMatch": {
        "csharp": {
            "both": [],
            "expressions": [],
            "functions": [
                [
                    "^\\s*static\\s+.*",
                    "Functions must start with 'static'"
                ],
                [
                    "^(?:.|\\n)*=>.*",
                    "Functions must include the symbol '=>'"
                ],
                [
                    "^(?:static\\s(?:.|\\n)*=>(?:.|\\n)*;\\s*)*$",
                    "Functions must follow the form: static <ReturnType> <NameStartingInUpperCase>(<parameters>) => <expression>;"
                ]
            ]
        },
        "python": {
            "both": [],
            "expressions": [],
            "functions": [
                [
                    "^def\\s.*",
                    "Function definitions must start with 'def '"
                ],
                [
                    "^def\\s+[a-z,_]+\\s*\\(.*",
                    "Function name should use only lower case letters or underscores"
                ],
                [
                    "^def\\s+[a-z,_]+\\s*\\(.*\\)\\s*:.*",
                    "Function signature should be followed by ':' (with or without a space) on the same line"
                ],
                [
                    "^def\\s+[a-z,_]+\\s*\\(.*\\)\\s*:\\s*return.*",
                    "The ':' should be followed by 'return' on the same line, or on the next line but indented"
                ],
                [
                    "^(?:def\\s+[a-z,_]+\\s*\\(.*\\)\\s*:\\s*return(?:.|\\\\\\n)*(?:\\n|$)|\\s*\\n)*$",
                    "All functions must follow the standard form: def <name_in_lower_case>(<parameters>): return <expression>"
                ]
            ]
        }
    },
    "CodeMustNotContain": {
        "csharp": {
            "both": [
                [
                    ".*(?:^|\\s+)(return|var|void|using|public|private|protected|class|abstract|readOnly)\\s.*",
                    "Messages.DisallowedKeyword"
                ],
                [
                    "(Console|System)\\.",
                    "Messages.NotPermitted"
                ],
                [
                    "\\w*[^(=|>|<)]=[^(=|>)]\\w*",
                    "Messages.Assignment"
                ],
                [
                    "\\W(ArrayList)\\W",
                    "Use of ArrayList is not permitted. Use a typed list such as List<int>"
                ],
                [
                    "\\.(Add|AddRange|Clear|RemoveAll|RemoveAt|RemoveRange)\\s*\\(",
                    "Messages.MutatingMethod"
                ]
            ],
            "expressions": [
                [
                    "(;)",
                    "Messages.NotPermitted"
                ]
            ],
            "functions": [
                [
                    "\\s+DateTime\\.(Today|Now)",
                    "Messages.ExternalDependency"
                ],
                [
                    "=>\\s*{",
                    "Function implementation may not start with curly brace '{'"
                ]
            ]
        },
        "python": {
            "both": [
                [
                    "(?:\\W|^)(print|input)\\s*\\(",
                    "Messages.NotPermitted"
                ],
                [
                    "(?:\\W|^)(append|clear|extend|insert|pop|reverse|sort)\\s*\\(",
                    "Use of '{1}', or any other method that mutates a List is not permitted"
                ],
                
                [
                    "\\w*[^=><]=[^(=|>)]\\w*",
                    "Messages.Assignment"
                ],
                [
                    "(;)",
                    "Messages.NotPermitted"
                ]
            ],
            "functions": [
                [
                    "\\s(date\\.today|datetime\\.today|datetime\\.now)",
                    "Messages.Message3"
                ]
            ]
        }
    }
}